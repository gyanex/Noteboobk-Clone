const require_chunk = require('./chunk-CUT6urMc.cjs');
const __llamaindex_workflow_core = require_chunk.__toESM(require("@llamaindex/workflow-core"));

//#region src/middleware/store.ts
function createStateMiddleware(init) {
	return {
		getContext: __llamaindex_workflow_core.getContext,
		withState: (workflow) => {
			return {
				...workflow,
				createContext: (input) => {
					const state = init(input);
					const context = workflow.createContext();
					context.__internal__call_context.subscribe((_, next) => {
						const context$1 = (0, __llamaindex_workflow_core.getContext)();
						if (!Reflect.has(context$1, "state")) Object.defineProperty(context$1, "state", { get: () => state });
						next(_);
					});
					if (!Reflect.has(context, "state")) Object.defineProperty(context, "state", { get: () => state });
					return context;
				}
			};
		}
	};
}

//#endregion
exports.createStateMiddleware = createStateMiddleware;
//# sourceMappingURL=store.cjs.map